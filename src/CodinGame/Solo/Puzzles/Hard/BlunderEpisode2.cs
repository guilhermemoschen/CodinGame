namespace Puzzles.Medium;

using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;

public static class BlunderEpisode2
{
    private static bool localDebug;

    public static void Main(string[] args)
    {
        string[] roomsAsString;

        if (args.Length == 0)
        {
            var totalRooms = int.Parse(Console.ReadLine()!, CultureInfo.InvariantCulture);
            roomsAsString = new string[totalRooms];
            for (int i = 0; i < totalRooms; i++)
            {
                roomsAsString[i] = Console.ReadLine()!;
            }
        }
        else
        {
            localDebug = true;
            roomsAsString = args.Skip(1).ToArray();
        }

        foreach (var room in roomsAsString)
        {
            Log(room);
        }

        var doors = roomsAsString.Select(s => new Room(s)).ToList();

        var solver = new Solver(doors);
        var maximumAmountMoney = solver.Solve();
        Console.WriteLine(maximumAmountMoney);
    }

    private static void Log(string message)
    {
        if (!localDebug)
        {
            return;
        }

        Console.Error.WriteLine(message);
    }

    private class Solver
    {
        private readonly List<Room> _rooms;

        public Solver(List<Room> doors)
        {
            _rooms = doors;
        }

        public int Solve()
        {
            var root = _rooms[0];

            return CalculateMoneyWithDfs(root.Clone(0, new bool[_rooms.Count]));
        }

        private int CalculateMoneyWithDfs(Room root)
        {
            var queue = new Queue<Room>();
            queue.Enqueue(root);

            var bestScores = new int[_rooms.Count];
            bestScores[root.Id] = root.Money;

            while (queue.Count != 0)
            {
                var currentRoom = queue.Dequeue();
                if (currentRoom.AggregatedValue < bestScores[currentRoom.Id])
                {
                    continue;
                }

                if (currentRoom.Door1Exit.HasValue && !currentRoom.Visited[currentRoom.Door1Exit.Value])
                {
                    var nextRoom = _rooms[currentRoom.Door1Exit.Value];
                    var bestScore = bestScores[nextRoom.Id];
                    if (currentRoom.AggregatedValue + nextRoom.Money > bestScore)
                    {
                        bestScores[nextRoom.Id] = currentRoom.AggregatedValue + nextRoom.Money;
                        queue.Enqueue(nextRoom.Clone(currentRoom.AggregatedValue, (bool[])currentRoom.Visited.Clone()));
                    }
                }

                if (currentRoom.Door2Exit.HasValue && !currentRoom.Visited[currentRoom.Door2Exit.Value])
                {
                    var nextRoom = _rooms[currentRoom.Door2Exit.Value];
                    var bestScore = bestScores[nextRoom.Id];
                    if (currentRoom.AggregatedValue + nextRoom.Money > bestScore)
                    {
                        bestScores[nextRoom.Id] = currentRoom.AggregatedValue + nextRoom.Money;
                        queue.Enqueue(nextRoom.Clone(currentRoom.AggregatedValue, (bool[])currentRoom.Visited.Clone()));
                    }
                }
            }

            return bestScores
                .OrderByDescending(p => p)
                .FirstOrDefault();
        }
    }

    private class Room
    {
        private Room()
        {
        }

        public Room(string roomAsString)
        {
            var inputs = roomAsString.Split(' ');
            Id = int.Parse(inputs[0], CultureInfo.InvariantCulture);
            Money = int.Parse(inputs[1], CultureInfo.InvariantCulture);
            Door1Exit = inputs[2] == "E" ? null : int.Parse(inputs[2], CultureInfo.InvariantCulture);
            Door2Exit = inputs[3] == "E" ? null : int.Parse(inputs[3], CultureInfo.InvariantCulture);
        }

        public int Id { get; init; }

        public int Money { get; init; }

        public int? Door1Exit { get; init; }

        public int? Door2Exit { get; init; }

        public int ParentValue { get; private set; }

        public int AggregatedValue => ParentValue + Money;

        public bool[] Visited { get; private set; } = Array.Empty<bool>();

        public Room Clone(int parentValue, bool[] visited)
        {
            visited[Id] = true;
            return new Room()
            {
                Id = Id,
                Door1Exit = Door1Exit,
                Door2Exit = Door2Exit,
                Money = Money,
                ParentValue = parentValue,
                Visited = visited,
            };
        }

        public override string ToString()
        {
            return $"{Id} - ${Money}";
        }
    }
}

public static class BlunderEpisode2TestCases
{
    public static readonly string[] OneRoom = new string[]
    {
            "1",
            "0 200 E E",
    };

    public static readonly string[] Sample = new string[]
    {
            "15",
            "0 17 1 2",
            "1 15 3 4",
            "2 15 4 5",
            "3 20 6 7",
            "4 12 7 8",
            "5 11 8 9",
            "6 18 10 11",
            "7 19 11 12",
            "8 12 12 13",
            "9 11 13 14",
            "10 13 E E",
            "11 14 E E",
            "12 17 E E",
            "13 19 E E",
            "14 15 E E",
    };

    public static readonly string[] Rooms1275 = new string[]
{
"1275",
"0 15 1 2",
"1 30 3 4",
"2 10 4 5",
"3 36 6 7",
"4 18 7 8",
"5 10 8 9",
"6 16 10 11",
"7 41 11 12",
"8 33 12 13",
"9 49 13 14",
"10 36 15 16",
"11 12 16 17",
"12 13 17 18",
"13 49 18 19",
"14 28 19 20",
"15 48 21 22",
"16 15 22 23",
"17 22 23 24",
"18 13 24 25",
"19 36 25 26",
"20 30 26 27",
"21 30 28 29",
"22 35 29 30",
"23 18 30 31",
"24 37 31 32",
"25 39 32 33",
"26 17 33 34",
"27 48 34 35",
"28 10 36 37",
"29 20 37 38",
"30 48 38 39",
"31 36 39 40",
"32 50 40 41",
"33 24 41 42",
"34 48 42 43",
"35 23 43 44",
"36 45 45 46",
"37 40 46 47",
"38 11 47 48",
"39 36 48 49",
"40 45 49 50",
"41 16 50 51",
"42 17 51 52",
"43 50 52 53",
"44 23 53 54",
"45 40 55 56",
"46 23 56 57",
"47 30 57 58",
"48 15 58 59",
"49 41 59 60",
"50 39 60 61",
"51 33 61 62",
"52 38 62 63",
"53 47 63 64",
"54 10 64 65",
"55 28 66 67",
"56 23 67 68",
"57 36 68 69",
"58 13 69 70",
"59 26 70 71",
"60 29 71 72",
"61 34 72 73",
"62 36 73 74",
"63 40 74 75",
"64 49 75 76",
"65 36 76 77",
"66 11 78 79",
"67 37 79 80",
"68 28 80 81",
"69 31 81 82",
"70 11 82 83",
"71 11 83 84",
"72 43 84 85",
"73 38 85 86",
"74 30 86 87",
"75 45 87 88",
"76 23 88 89",
"77 47 89 90",
"78 41 91 92",
"79 37 92 93",
"80 47 93 94",
"81 37 94 95",
"82 11 95 96",
"83 20 96 97",
"84 49 97 98",
"85 24 98 99",
"86 34 99 100",
"87 39 100 101",
"88 25 101 102",
"89 15 102 103",
"90 12 103 104",
"91 19 105 106",
"92 11 106 107",
"93 11 107 108",
"94 35 108 109",
"95 18 109 110",
"96 48 110 111",
"97 28 111 112",
"98 19 112 113",
"99 34 113 114",
"100 40 114 115",
"101 43 115 116",
"102 25 116 117",
"103 20 117 118",
"104 38 118 119",
"105 18 120 121",
"106 42 121 122",
"107 18 122 123",
"108 32 123 124",
"109 47 124 125",
"110 10 125 126",
"111 22 126 127",
"112 27 127 128",
"113 42 128 129",
"114 12 129 130",
"115 31 130 131",
"116 35 131 132",
"117 46 132 133",
"118 37 133 134",
"119 21 134 135",
"120 31 136 137",
"121 10 137 138",
"122 44 138 139",
"123 30 139 140",
"124 46 140 141",
"125 12 141 142",
"126 25 142 143",
"127 20 143 144",
"128 43 144 145",
"129 12 145 146",
"130 42 146 147",
"131 45 147 148",
"132 44 148 149",
"133 47 149 150",
"134 43 150 151",
"135 49 151 152",
"136 28 153 154",
"137 27 154 155",
"138 42 155 156",
"139 26 156 157",
"140 10 157 158",
"141 41 158 159",
"142 36 159 160",
"143 41 160 161",
"144 27 161 162",
"145 30 162 163",
"146 45 163 164",
"147 27 164 165",
"148 32 165 166",
"149 33 166 167",
"150 36 167 168",
"151 33 168 169",
"152 41 169 170",
"153 36 171 172",
"154 48 172 173",
"155 33 173 174",
"156 39 174 175",
"157 21 175 176",
"158 17 176 177",
"159 35 177 178",
"160 43 178 179",
"161 45 179 180",
"162 35 180 181",
"163 39 181 182",
"164 39 182 183",
"165 39 183 184",
"166 24 184 185",
"167 18 185 186",
"168 12 186 187",
"169 44 187 188",
"170 28 188 189",
"171 43 190 191",
"172 25 191 192",
"173 46 192 193",
"174 19 193 194",
"175 44 194 195",
"176 45 195 196",
"177 43 196 197",
"178 25 197 198",
"179 45 198 199",
"180 14 199 200",
"181 48 200 201",
"182 34 201 202",
"183 27 202 203",
"184 13 203 204",
"185 34 204 205",
"186 23 205 206",
"187 23 206 207",
"188 48 207 208",
"189 23 208 209",
"190 43 210 211",
"191 40 211 212",
"192 23 212 213",
"193 49 213 214",
"194 49 214 215",
"195 33 215 216",
"196 20 216 217",
"197 38 217 218",
"198 26 218 219",
"199 11 219 220",
"200 20 220 221",
"201 11 221 222",
"202 34 222 223",
"203 33 223 224",
"204 28 224 225",
"205 50 225 226",
"206 15 226 227",
"207 27 227 228",
"208 29 228 229",
"209 33 229 230",
"210 19 231 232",
"211 32 232 233",
"212 40 233 234",
"213 11 234 235",
"214 19 235 236",
"215 29 236 237",
"216 17 237 238",
"217 38 238 239",
"218 43 239 240",
"219 37 240 241",
"220 29 241 242",
"221 31 242 243",
"222 39 243 244",
"223 36 244 245",
"224 21 245 246",
"225 46 246 247",
"226 31 247 248",
"227 10 248 249",
"228 28 249 250",
"229 44 250 251",
"230 16 251 252",
"231 16 253 254",
"232 36 254 255",
"233 16 255 256",
"234 43 256 257",
"235 18 257 258",
"236 17 258 259",
"237 46 259 260",
"238 37 260 261",
"239 45 261 262",
"240 44 262 263",
"241 50 263 264",
"242 45 264 265",
"243 31 265 266",
"244 35 266 267",
"245 48 267 268",
"246 41 268 269",
"247 16 269 270",
"248 29 270 271",
"249 25 271 272",
"250 42 272 273",
"251 18 273 274",
"252 22 274 275",
"253 17 276 277",
"254 45 277 278",
"255 46 278 279",
"256 22 279 280",
"257 43 280 281",
"258 12 281 282",
"259 15 282 283",
"260 22 283 284",
"261 16 284 285",
"262 25 285 286",
"263 46 286 287",
"264 32 287 288",
"265 26 288 289",
"266 23 289 290",
"267 28 290 291",
"268 20 291 292",
"269 44 292 293",
"270 25 293 294",
"271 37 294 295",
"272 29 295 296",
"273 38 296 297",
"274 43 297 298",
"275 45 298 299",
"276 21 300 301",
"277 40 301 302",
"278 23 302 303",
"279 21 303 304",
"280 16 304 305",
"281 44 305 306",
"282 12 306 307",
"283 47 307 308",
"284 50 308 309",
"285 37 309 310",
"286 44 310 311",
"287 37 311 312",
"288 45 312 313",
"289 37 313 314",
"290 24 314 315",
"291 49 315 316",
"292 35 316 317",
"293 19 317 318",
"294 36 318 319",
"295 10 319 320",
"296 39 320 321",
"297 30 321 322",
"298 11 322 323",
"299 45 323 324",
"300 19 325 326",
"301 43 326 327",
"302 41 327 328",
"303 23 328 329",
"304 34 329 330",
"305 35 330 331",
"306 30 331 332",
"307 43 332 333",
"308 25 333 334",
"309 17 334 335",
"310 16 335 336",
"311 13 336 337",
"312 15 337 338",
"313 15 338 339",
"314 19 339 340",
"315 47 340 341",
"316 18 341 342",
"317 20 342 343",
"318 33 343 344",
"319 29 344 345",
"320 36 345 346",
"321 30 346 347",
"322 15 347 348",
"323 16 348 349",
"324 41 349 350",
"325 14 351 352",
"326 25 352 353",
"327 36 353 354",
"328 14 354 355",
"329 46 355 356",
"330 37 356 357",
"331 48 357 358",
"332 34 358 359",
"333 25 359 360",
"334 20 360 361",
"335 33 361 362",
"336 10 362 363",
"337 11 363 364",
"338 16 364 365",
"339 21 365 366",
"340 29 366 367",
"341 15 367 368",
"342 12 368 369",
"343 41 369 370",
"344 33 370 371",
"345 45 371 372",
"346 41 372 373",
"347 24 373 374",
"348 21 374 375",
"349 29 375 376",
"350 34 376 377",
"351 49 378 379",
"352 25 379 380",
"353 45 380 381",
"354 30 381 382",
"355 21 382 383",
"356 31 383 384",
"357 47 384 385",
"358 12 385 386",
"359 31 386 387",
"360 41 387 388",
"361 44 388 389",
"362 39 389 390",
"363 36 390 391",
"364 37 391 392",
"365 46 392 393",
"366 37 393 394",
"367 30 394 395",
"368 42 395 396",
"369 36 396 397",
"370 27 397 398",
"371 22 398 399",
"372 24 399 400",
"373 21 400 401",
"374 50 401 402",
"375 30 402 403",
"376 19 403 404",
"377 16 404 405",
"378 47 406 407",
"379 30 407 408",
"380 37 408 409",
"381 21 409 410",
"382 24 410 411",
"383 14 411 412",
"384 36 412 413",
"385 14 413 414",
"386 20 414 415",
"387 20 415 416",
"388 22 416 417",
"389 40 417 418",
"390 37 418 419",
"391 19 419 420",
"392 31 420 421",
"393 41 421 422",
"394 35 422 423",
"395 40 423 424",
"396 36 424 425",
"397 21 425 426",
"398 42 426 427",
"399 10 427 428",
"400 26 428 429",
"401 39 429 430",
"402 29 430 431",
"403 20 431 432",
"404 49 432 433",
"405 19 433 434",
"406 20 435 436",
"407 40 436 437",
"408 44 437 438",
"409 14 438 439",
"410 20 439 440",
"411 14 440 441",
"412 50 441 442",
"413 43 442 443",
"414 26 443 444",
"415 29 444 445",
"416 36 445 446",
"417 48 446 447",
"418 15 447 448",
"419 15 448 449",
"420 36 449 450",
"421 34 450 451",
"422 46 451 452",
"423 18 452 453",
"424 36 453 454",
"425 25 454 455",
"426 13 455 456",
"427 39 456 457",
"428 16 457 458",
"429 36 458 459",
"430 28 459 460",
"431 24 460 461",
"432 47 461 462",
"433 25 462 463",
"434 36 463 464",
"435 35 465 466",
"436 25 466 467",
"437 45 467 468",
"438 28 468 469",
"439 38 469 470",
"440 37 470 471",
"441 22 471 472",
"442 23 472 473",
"443 42 473 474",
"444 21 474 475",
"445 45 475 476",
"446 43 476 477",
"447 47 477 478",
"448 34 478 479",
"449 11 479 480",
"450 34 480 481",
"451 20 481 482",
"452 38 482 483",
"453 43 483 484",
"454 19 484 485",
"455 15 485 486",
"456 48 486 487",
"457 36 487 488",
"458 44 488 489",
"459 40 489 490",
"460 15 490 491",
"461 47 491 492",
"462 17 492 493",
"463 36 493 494",
"464 29 494 495",
"465 31 496 497",
"466 48 497 498",
"467 26 498 499",
"468 18 499 500",
"469 18 500 501",
"470 33 501 502",
"471 39 502 503",
"472 50 503 504",
"473 47 504 505",
"474 12 505 506",
"475 11 506 507",
"476 16 507 508",
"477 30 508 509",
"478 44 509 510",
"479 41 510 511",
"480 13 511 512",
"481 30 512 513",
"482 31 513 514",
"483 20 514 515",
"484 19 515 516",
"485 34 516 517",
"486 25 517 518",
"487 30 518 519",
"488 26 519 520",
"489 23 520 521",
"490 26 521 522",
"491 13 522 523",
"492 49 523 524",
"493 22 524 525",
"494 27 525 526",
"495 43 526 527",
"496 21 528 529",
"497 13 529 530",
"498 36 530 531",
"499 50 531 532",
"500 32 532 533",
"501 30 533 534",
"502 47 534 535",
"503 10 535 536",
"504 40 536 537",
"505 38 537 538",
"506 22 538 539",
"507 10 539 540",
"508 25 540 541",
"509 37 541 542",
"510 27 542 543",
"511 39 543 544",
"512 36 544 545",
"513 28 545 546",
"514 38 546 547",
"515 36 547 548",
"516 29 548 549",
"517 29 549 550",
"518 12 550 551",
"519 50 551 552",
"520 27 552 553",
"521 35 553 554",
"522 20 554 555",
"523 26 555 556",
"524 28 556 557",
"525 30 557 558",
"526 28 558 559",
"527 26 559 560",
"528 39 561 562",
"529 12 562 563",
"530 39 563 564",
"531 29 564 565",
"532 15 565 566",
"533 14 566 567",
"534 27 567 568",
"535 21 568 569",
"536 31 569 570",
"537 18 570 571",
"538 28 571 572",
"539 13 572 573",
"540 31 573 574",
"541 37 574 575",
"542 46 575 576",
"543 31 576 577",
"544 47 577 578",
"545 14 578 579",
"546 11 579 580",
"547 28 580 581",
"548 17 581 582",
"549 13 582 583",
"550 19 583 584",
"551 42 584 585",
"552 30 585 586",
"553 30 586 587",
"554 42 587 588",
"555 50 588 589",
"556 39 589 590",
"557 29 590 591",
"558 29 591 592",
"559 48 592 593",
"560 50 593 594",
"561 26 595 596",
"562 33 596 597",
"563 37 597 598",
"564 38 598 599",
"565 23 599 600",
"566 29 600 601",
"567 40 601 602",
"568 26 602 603",
"569 30 603 604",
"570 22 604 605",
"571 28 605 606",
"572 39 606 607",
"573 12 607 608",
"574 28 608 609",
"575 48 609 610",
"576 17 610 611",
"577 44 611 612",
"578 36 612 613",
"579 27 613 614",
"580 29 614 615",
"581 15 615 616",
"582 17 616 617",
"583 50 617 618",
"584 14 618 619",
"585 38 619 620",
"586 18 620 621",
"587 47 621 622",
"588 32 622 623",
"589 27 623 624",
"590 20 624 625",
"591 20 625 626",
"592 44 626 627",
"593 23 627 628",
"594 16 628 629",
"595 16 630 631",
"596 19 631 632",
"597 18 632 633",
"598 35 633 634",
"599 19 634 635",
"600 15 635 636",
"601 13 636 637",
"602 35 637 638",
"603 18 638 639",
"604 42 639 640",
"605 29 640 641",
"606 42 641 642",
"607 29 642 643",
"608 20 643 644",
"609 10 644 645",
"610 26 645 646",
"611 29 646 647",
"612 10 647 648",
"613 31 648 649",
"614 11 649 650",
"615 31 650 651",
"616 42 651 652",
"617 11 652 653",
"618 27 653 654",
"619 16 654 655",
"620 10 655 656",
"621 22 656 657",
"622 46 657 658",
"623 24 658 659",
"624 15 659 660",
"625 38 660 661",
"626 37 661 662",
"627 47 662 663",
"628 41 663 664",
"629 21 664 665",
"630 39 666 667",
"631 17 667 668",
"632 46 668 669",
"633 17 669 670",
"634 23 670 671",
"635 28 671 672",
"636 20 672 673",
"637 31 673 674",
"638 41 674 675",
"639 50 675 676",
"640 42 676 677",
"641 25 677 678",
"642 46 678 679",
"643 12 679 680",
"644 38 680 681",
"645 33 681 682",
"646 17 682 683",
"647 11 683 684",
"648 23 684 685",
"649 37 685 686",
"650 16 686 687",
"651 45 687 688",
"652 37 688 689",
"653 19 689 690",
"654 39 690 691",
"655 32 691 692",
"656 18 692 693",
"657 10 693 694",
"658 35 694 695",
"659 25 695 696",
"660 36 696 697",
"661 19 697 698",
"662 10 698 699",
"663 23 699 700",
"664 18 700 701",
"665 42 701 702",
"666 21 703 704",
"667 49 704 705",
"668 49 705 706",
"669 45 706 707",
"670 48 707 708",
"671 10 708 709",
"672 47 709 710",
"673 45 710 711",
"674 43 711 712",
"675 20 712 713",
"676 38 713 714",
"677 15 714 715",
"678 16 715 716",
"679 31 716 717",
"680 18 717 718",
"681 43 718 719",
"682 47 719 720",
"683 28 720 721",
"684 19 721 722",
"685 30 722 723",
"686 32 723 724",
"687 20 724 725",
"688 21 725 726",
"689 50 726 727",
"690 34 727 728",
"691 50 728 729",
"692 12 729 730",
"693 48 730 731",
"694 28 731 732",
"695 21 732 733",
"696 42 733 734",
"697 35 734 735",
"698 26 735 736",
"699 15 736 737",
"700 24 737 738",
"701 19 738 739",
"702 17 739 740",
"703 46 741 742",
"704 46 742 743",
"705 27 743 744",
"706 13 744 745",
"707 39 745 746",
"708 11 746 747",
"709 14 747 748",
"710 11 748 749",
"711 23 749 750",
"712 35 750 751",
"713 47 751 752",
"714 11 752 753",
"715 26 753 754",
"716 26 754 755",
"717 23 755 756",
"718 12 756 757",
"719 14 757 758",
"720 33 758 759",
"721 14 759 760",
"722 12 760 761",
"723 37 761 762",
"724 11 762 763",
"725 12 763 764",
"726 25 764 765",
"727 34 765 766",
"728 20 766 767",
"729 25 767 768",
"730 17 768 769",
"731 22 769 770",
"732 15 770 771",
"733 23 771 772",
"734 41 772 773",
"735 15 773 774",
"736 31 774 775",
"737 17 775 776",
"738 17 776 777",
"739 20 777 778",
"740 15 778 779",
"741 20 780 781",
"742 30 781 782",
"743 10 782 783",
"744 44 783 784",
"745 47 784 785",
"746 11 785 786",
"747 30 786 787",
"748 38 787 788",
"749 23 788 789",
"750 37 789 790",
"751 19 790 791",
"752 45 791 792",
"753 24 792 793",
"754 24 793 794",
"755 36 794 795",
"756 10 795 796",
"757 33 796 797",
"758 19 797 798",
"759 17 798 799",
"760 34 799 800",
"761 49 800 801",
"762 12 801 802",
"763 33 802 803",
"764 50 803 804",
"765 10 804 805",
"766 38 805 806",
"767 49 806 807",
"768 44 807 808",
"769 14 808 809",
"770 22 809 810",
"771 11 810 811",
"772 25 811 812",
"773 42 812 813",
"774 22 813 814",
"775 49 814 815",
"776 14 815 816",
"777 19 816 817",
"778 48 817 818",
"779 36 818 819",
"780 12 820 821",
"781 42 821 822",
"782 13 822 823",
"783 38 823 824",
"784 27 824 825",
"785 45 825 826",
"786 14 826 827",
"787 16 827 828",
"788 25 828 829",
"789 26 829 830",
"790 39 830 831",
"791 45 831 832",
"792 11 832 833",
"793 17 833 834",
"794 47 834 835",
"795 39 835 836",
"796 12 836 837",
"797 14 837 838",
"798 17 838 839",
"799 36 839 840",
"800 27 840 841",
"801 44 841 842",
"802 48 842 843",
"803 32 843 844",
"804 29 844 845",
"805 18 845 846",
"806 50 846 847",
"807 46 847 848",
"808 49 848 849",
"809 14 849 850",
"810 37 850 851",
"811 36 851 852",
"812 36 852 853",
"813 39 853 854",
"814 34 854 855",
"815 42 855 856",
"816 37 856 857",
"817 44 857 858",
"818 47 858 859",
"819 11 859 860",
"820 13 861 862",
"821 15 862 863",
"822 14 863 864",
"823 11 864 865",
"824 24 865 866",
"825 24 866 867",
"826 17 867 868",
"827 13 868 869",
"828 10 869 870",
"829 13 870 871",
"830 13 871 872",
"831 33 872 873",
"832 23 873 874",
"833 43 874 875",
"834 24 875 876",
"835 14 876 877",
"836 45 877 878",
"837 28 878 879",
"838 48 879 880",
"839 11 880 881",
"840 20 881 882",
"841 18 882 883",
"842 12 883 884",
"843 43 884 885",
"844 11 885 886",
"845 23 886 887",
"846 41 887 888",
"847 46 888 889",
"848 46 889 890",
"849 20 890 891",
"850 28 891 892",
"851 24 892 893",
"852 38 893 894",
"853 16 894 895",
"854 30 895 896",
"855 10 896 897",
"856 14 897 898",
"857 44 898 899",
"858 25 899 900",
"859 46 900 901",
"860 27 901 902",
"861 22 903 904",
"862 22 904 905",
"863 28 905 906",
"864 10 906 907",
"865 23 907 908",
"866 15 908 909",
"867 42 909 910",
"868 44 910 911",
"869 10 911 912",
"870 48 912 913",
"871 41 913 914",
"872 46 914 915",
"873 39 915 916",
"874 42 916 917",
"875 28 917 918",
"876 26 918 919",
"877 40 919 920",
"878 23 920 921",
"879 32 921 922",
"880 10 922 923",
"881 44 923 924",
"882 21 924 925",
"883 50 925 926",
"884 41 926 927",
"885 23 927 928",
"886 42 928 929",
"887 31 929 930",
"888 24 930 931",
"889 33 931 932",
"890 36 932 933",
"891 18 933 934",
"892 38 934 935",
"893 28 935 936",
"894 43 936 937",
"895 35 937 938",
"896 46 938 939",
"897 34 939 940",
"898 28 940 941",
"899 34 941 942",
"900 17 942 943",
"901 45 943 944",
"902 11 944 945",
"903 39 946 947",
"904 15 947 948",
"905 33 948 949",
"906 16 949 950",
"907 48 950 951",
"908 29 951 952",
"909 11 952 953",
"910 44 953 954",
"911 16 954 955",
"912 29 955 956",
"913 14 956 957",
"914 45 957 958",
"915 44 958 959",
"916 37 959 960",
"917 16 960 961",
"918 37 961 962",
"919 47 962 963",
"920 14 963 964",
"921 25 964 965",
"922 24 965 966",
"923 50 966 967",
"924 24 967 968",
"925 16 968 969",
"926 37 969 970",
"927 45 970 971",
"928 19 971 972",
"929 23 972 973",
"930 18 973 974",
"931 31 974 975",
"932 13 975 976",
"933 36 976 977",
"934 14 977 978",
"935 31 978 979",
"936 28 979 980",
"937 44 980 981",
"938 31 981 982",
"939 31 982 983",
"940 26 983 984",
"941 49 984 985",
"942 38 985 986",
"943 37 986 987",
"944 10 987 988",
"945 17 988 989",
"946 42 990 991",
"947 37 991 992",
"948 42 992 993",
"949 26 993 994",
"950 48 994 995",
"951 45 995 996",
"952 44 996 997",
"953 17 997 998",
"954 24 998 999",
"955 26 999 1000",
"956 21 1000 1001",
"957 12 1001 1002",
"958 23 1002 1003",
"959 15 1003 1004",
"960 19 1004 1005",
"961 15 1005 1006",
"962 41 1006 1007",
"963 50 1007 1008",
"964 20 1008 1009",
"965 18 1009 1010",
"966 36 1010 1011",
"967 40 1011 1012",
"968 23 1012 1013",
"969 43 1013 1014",
"970 41 1014 1015",
"971 19 1015 1016",
"972 30 1016 1017",
"973 17 1017 1018",
"974 47 1018 1019",
"975 22 1019 1020",
"976 30 1020 1021",
"977 21 1021 1022",
"978 39 1022 1023",
"979 50 1023 1024",
"980 12 1024 1025",
"981 26 1025 1026",
"982 39 1026 1027",
"983 24 1027 1028",
"984 27 1028 1029",
"985 16 1029 1030",
"986 41 1030 1031",
"987 50 1031 1032",
"988 37 1032 1033",
"989 29 1033 1034",
"990 42 1035 1036",
"991 24 1036 1037",
"992 39 1037 1038",
"993 44 1038 1039",
"994 17 1039 1040",
"995 12 1040 1041",
"996 43 1041 1042",
"997 33 1042 1043",
"998 11 1043 1044",
"999 33 1044 1045",
"1000 19 1045 1046",
"1001 22 1046 1047",
"1002 13 1047 1048",
"1003 27 1048 1049",
"1004 16 1049 1050",
"1005 22 1050 1051",
"1006 13 1051 1052",
"1007 22 1052 1053",
"1008 48 1053 1054",
"1009 38 1054 1055",
"1010 50 1055 1056",
"1011 30 1056 1057",
"1012 20 1057 1058",
"1013 36 1058 1059",
"1014 13 1059 1060",
"1015 42 1060 1061",
"1016 47 1061 1062",
"1017 37 1062 1063",
"1018 47 1063 1064",
"1019 42 1064 1065",
"1020 50 1065 1066",
"1021 40 1066 1067",
"1022 40 1067 1068",
"1023 32 1068 1069",
"1024 45 1069 1070",
"1025 19 1070 1071",
"1026 20 1071 1072",
"1027 17 1072 1073",
"1028 43 1073 1074",
"1029 25 1074 1075",
"1030 32 1075 1076",
"1031 25 1076 1077",
"1032 35 1077 1078",
"1033 31 1078 1079",
"1034 48 1079 1080",
"1035 46 1081 1082",
"1036 13 1082 1083",
"1037 29 1083 1084",
"1038 50 1084 1085",
"1039 28 1085 1086",
"1040 23 1086 1087",
"1041 29 1087 1088",
"1042 23 1088 1089",
"1043 19 1089 1090",
"1044 35 1090 1091",
"1045 43 1091 1092",
"1046 31 1092 1093",
"1047 32 1093 1094",
"1048 36 1094 1095",
"1049 50 1095 1096",
"1050 24 1096 1097",
"1051 14 1097 1098",
"1052 27 1098 1099",
"1053 26 1099 1100",
"1054 45 1100 1101",
"1055 20 1101 1102",
"1056 38 1102 1103",
"1057 34 1103 1104",
"1058 20 1104 1105",
"1059 13 1105 1106",
"1060 20 1106 1107",
"1061 29 1107 1108",
"1062 32 1108 1109",
"1063 27 1109 1110",
"1064 31 1110 1111",
"1065 31 1111 1112",
"1066 45 1112 1113",
"1067 26 1113 1114",
"1068 32 1114 1115",
"1069 47 1115 1116",
"1070 22 1116 1117",
"1071 47 1117 1118",
"1072 37 1118 1119",
"1073 44 1119 1120",
"1074 42 1120 1121",
"1075 19 1121 1122",
"1076 35 1122 1123",
"1077 33 1123 1124",
"1078 42 1124 1125",
"1079 14 1125 1126",
"1080 27 1126 1127",
"1081 28 1128 1129",
"1082 31 1129 1130",
"1083 38 1130 1131",
"1084 22 1131 1132",
"1085 12 1132 1133",
"1086 50 1133 1134",
"1087 17 1134 1135",
"1088 33 1135 1136",
"1089 36 1136 1137",
"1090 45 1137 1138",
"1091 37 1138 1139",
"1092 24 1139 1140",
"1093 16 1140 1141",
"1094 37 1141 1142",
"1095 43 1142 1143",
"1096 40 1143 1144",
"1097 45 1144 1145",
"1098 21 1145 1146",
"1099 45 1146 1147",
"1100 30 1147 1148",
"1101 20 1148 1149",
"1102 47 1149 1150",
"1103 19 1150 1151",
"1104 11 1151 1152",
"1105 41 1152 1153",
"1106 43 1153 1154",
"1107 19 1154 1155",
"1108 48 1155 1156",
"1109 27 1156 1157",
"1110 40 1157 1158",
"1111 12 1158 1159",
"1112 42 1159 1160",
"1113 28 1160 1161",
"1114 41 1161 1162",
"1115 24 1162 1163",
"1116 32 1163 1164",
"1117 50 1164 1165",
"1118 23 1165 1166",
"1119 13 1166 1167",
"1120 49 1167 1168",
"1121 39 1168 1169",
"1122 13 1169 1170",
"1123 11 1170 1171",
"1124 37 1171 1172",
"1125 18 1172 1173",
"1126 34 1173 1174",
"1127 33 1174 1175",
"1128 13 1176 1177",
"1129 28 1177 1178",
"1130 34 1178 1179",
"1131 17 1179 1180",
"1132 25 1180 1181",
"1133 30 1181 1182",
"1134 18 1182 1183",
"1135 14 1183 1184",
"1136 20 1184 1185",
"1137 43 1185 1186",
"1138 50 1186 1187",
"1139 12 1187 1188",
"1140 27 1188 1189",
"1141 23 1189 1190",
"1142 27 1190 1191",
"1143 24 1191 1192",
"1144 36 1192 1193",
"1145 16 1193 1194",
"1146 13 1194 1195",
"1147 30 1195 1196",
"1148 22 1196 1197",
"1149 19 1197 1198",
"1150 35 1198 1199",
"1151 28 1199 1200",
"1152 26 1200 1201",
"1153 42 1201 1202",
"1154 14 1202 1203",
"1155 49 1203 1204",
"1156 41 1204 1205",
"1157 34 1205 1206",
"1158 39 1206 1207",
"1159 46 1207 1208",
"1160 22 1208 1209",
"1161 18 1209 1210",
"1162 45 1210 1211",
"1163 15 1211 1212",
"1164 29 1212 1213",
"1165 37 1213 1214",
"1166 21 1214 1215",
"1167 16 1215 1216",
"1168 28 1216 1217",
"1169 39 1217 1218",
"1170 22 1218 1219",
"1171 14 1219 1220",
"1172 23 1220 1221",
"1173 29 1221 1222",
"1174 23 1222 1223",
"1175 42 1223 1224",
"1176 47 1225 1226",
"1177 17 1226 1227",
"1178 11 1227 1228",
"1179 20 1228 1229",
"1180 36 1229 1230",
"1181 47 1230 1231",
"1182 46 1231 1232",
"1183 14 1232 1233",
"1184 34 1233 1234",
"1185 36 1234 1235",
"1186 11 1235 1236",
"1187 39 1236 1237",
"1188 24 1237 1238",
"1189 13 1238 1239",
"1190 39 1239 1240",
"1191 45 1240 1241",
"1192 17 1241 1242",
"1193 24 1242 1243",
"1194 43 1243 1244",
"1195 13 1244 1245",
"1196 39 1245 1246",
"1197 20 1246 1247",
"1198 25 1247 1248",
"1199 48 1248 1249",
"1200 22 1249 1250",
"1201 29 1250 1251",
"1202 45 1251 1252",
"1203 35 1252 1253",
"1204 30 1253 1254",
"1205 23 1254 1255",
"1206 10 1255 1256",
"1207 40 1256 1257",
"1208 42 1257 1258",
"1209 50 1258 1259",
"1210 40 1259 1260",
"1211 17 1260 1261",
"1212 42 1261 1262",
"1213 12 1262 1263",
"1214 48 1263 1264",
"1215 34 1264 1265",
"1216 40 1265 1266",
"1217 42 1266 1267",
"1218 19 1267 1268",
"1219 19 1268 1269",
"1220 46 1269 1270",
"1221 37 1270 1271",
"1222 33 1271 1272",
"1223 36 1272 1273",
"1224 20 1273 1274",
"1225 23 E E",
"1226 23 E E",
"1227 32 E E",
"1228 24 E E",
"1229 14 E E",
"1230 47 E E",
"1231 22 E E",
"1232 19 E E",
"1233 35 E E",
"1234 36 E E",
"1235 25 E E",
"1236 36 E E",
"1237 31 E E",
"1238 37 E E",
"1239 36 E E",
"1240 26 E E",
"1241 28 E E",
"1242 47 E E",
"1243 25 E E",
"1244 38 E E",
"1245 23 E E",
"1246 45 E E",
"1247 48 E E",
"1248 43 E E",
"1249 44 E E",
"1250 11 E E",
"1251 33 E E",
"1252 22 E E",
"1253 16 E E",
"1254 45 E E",
"1255 39 E E",
"1256 12 E E",
"1257 23 E E",
"1258 48 E E",
"1259 22 E E",
"1260 11 E E",
"1261 45 E E",
"1262 24 E E",
"1263 32 E E",
"1264 46 E E",
"1265 29 E E",
"1266 44 E E",
"1267 34 E E",
"1268 32 E E",
"1269 16 E E",
"1270 40 E E",
"1271 30 E E",
"1272 49 E E",
"1273 13 E E",
"1274 21 E E",
};

    public static readonly string[] SquareBuilding = new string[]
    {
"400",
"0 1 1 39",
"1 1 2 38",
"2 1 3 37",
"3 1 4 36",
"4 1 5 35",
"5 1 6 34",
"6 1 7 33",
"7 1 8 32",
"8 1 9 31",
"9 1 10 30",
"10 1 11 29",
"11 1 12 28",
"12 1 13 27",
"13 1 14 26",
"14 1 15 25",
"15 1 16 24",
"16 1 17 23",
"17 1 18 22",
"18 1 19 21",
"19 1 E 20",
"20 1 21 59",
"21 1 22 58",
"22 1 23 57",
"23 1 24 56",
"24 1 25 55",
"25 1 26 54",
"26 1 27 53",
"27 1 28 52",
"28 1 29 51",
"29 1 30 50",
"30 1 31 49",
"31 1 32 48",
"32 1 33 47",
"33 1 34 46",
"34 1 35 45",
"35 1 36 44",
"36 1 37 43",
"37 1 38 42",
"38 1 39 41",
"39 1 E 40",
"40 1 41 79",
"41 1 42 78",
"42 1 43 77",
"43 1 44 76",
"44 1 45 75",
"45 1 46 74",
"46 1 47 73",
"47 1 48 72",
"48 1 49 71",
"49 1 50 70",
"50 1 51 69",
"51 1 52 68",
"52 1 53 67",
"53 1 54 66",
"54 1 55 65",
"55 1 56 64",
"56 1 57 63",
"57 1 58 62",
"58 1 59 61",
"59 1 E 60",
"60 1 61 99",
"61 1 62 98",
"62 1 63 97",
"63 1 64 96",
"64 1 65 95",
"65 1 66 94",
"66 1 67 93",
"67 1 68 92",
"68 1 69 91",
"69 1 70 90",
"70 1 71 89",
"71 1 72 88",
"72 1 73 87",
"73 1 74 86",
"74 1 75 85",
"75 1 76 84",
"76 1 77 83",
"77 1 78 82",
"78 1 79 81",
"79 1 E 80",
"80 1 81 119",
"81 1 82 118",
"82 1 83 117",
"83 1 84 116",
"84 1 85 115",
"85 1 86 114",
"86 1 87 113",
"87 1 88 112",
"88 1 89 111",
"89 1 90 110",
"90 1 91 109",
"91 1 92 108",
"92 1 93 107",
"93 1 94 106",
"94 1 95 105",
"95 1 96 104",
"96 1 97 103",
"97 1 98 102",
"98 1 99 101",
"99 1 E 100",
"100 1 101 139",
"101 1 102 138",
"102 1 103 137",
"103 1 104 136",
"104 1 105 135",
"105 1 106 134",
"106 1 107 133",
"107 1 108 132",
"108 1 109 131",
"109 1 110 130",
"110 1 111 129",
"111 1 112 128",
"112 1 113 127",
"113 1 114 126",
"114 1 115 125",
"115 1 116 124",
"116 1 117 123",
"117 1 118 122",
"118 1 119 121",
"119 1 E 120",
"120 1 121 159",
"121 1 122 158",
"122 1 123 157",
"123 1 124 156",
"124 1 125 155",
"125 1 126 154",
"126 1 127 153",
"127 1 128 152",
"128 1 129 151",
"129 1 130 150",
"130 1 131 149",
"131 1 132 148",
"132 1 133 147",
"133 1 134 146",
"134 1 135 145",
"135 1 136 144",
"136 1 137 143",
"137 1 138 142",
"138 1 139 141",
"139 1 E 140",
"140 1 141 179",
"141 1 142 178",
"142 1 143 177",
"143 1 144 176",
"144 1 145 175",
"145 1 146 174",
"146 1 147 173",
"147 1 148 172",
"148 1 149 171",
"149 1 150 170",
"150 1 151 169",
"151 1 152 168",
"152 1 153 167",
"153 1 154 166",
"154 1 155 165",
"155 1 156 164",
"156 1 157 163",
"157 1 158 162",
"158 1 159 161",
"159 1 E 160",
"160 1 161 199",
"161 1 162 198",
"162 1 163 197",
"163 1 164 196",
"164 1 165 195",
"165 1 166 194",
"166 1 167 193",
"167 1 168 192",
"168 1 169 191",
"169 1 170 190",
"170 1 171 189",
"171 1 172 188",
"172 1 173 187",
"173 1 174 186",
"174 1 175 185",
"175 1 176 184",
"176 1 177 183",
"177 1 178 182",
"178 1 179 181",
"179 1 E 180",
"180 1 181 219",
"181 1 182 218",
"182 1 183 217",
"183 1 184 216",
"184 1 185 215",
"185 1 186 214",
"186 1 187 213",
"187 1 188 212",
"188 1 189 211",
"189 1 190 210",
"190 1 191 209",
"191 1 192 208",
"192 1 193 207",
"193 1 194 206",
"194 1 195 205",
"195 1 196 204",
"196 1 197 203",
"197 1 198 202",
"198 1 199 201",
"199 1 E 200",
"200 1 201 239",
"201 1 202 238",
"202 1 203 237",
"203 1 204 236",
"204 1 205 235",
"205 1 206 234",
"206 1 207 233",
"207 1 208 232",
"208 1 209 231",
"209 1 210 230",
"210 1 211 229",
"211 1 212 228",
"212 1 213 227",
"213 1 214 226",
"214 1 215 225",
"215 1 216 224",
"216 1 217 223",
"217 1 218 222",
"218 1 219 221",
"219 1 E 220",
"220 1 221 259",
"221 1 222 258",
"222 1 223 257",
"223 1 224 256",
"224 1 225 255",
"225 1 226 254",
"226 1 227 253",
"227 1 228 252",
"228 1 229 251",
"229 1 230 250",
"230 1 231 249",
"231 1 232 248",
"232 1 233 247",
"233 1 234 246",
"234 1 235 245",
"235 1 236 244",
"236 1 237 243",
"237 1 238 242",
"238 1 239 241",
"239 1 E 240",
"240 1 241 279",
"241 1 242 278",
"242 1 243 277",
"243 1 244 276",
"244 1 245 275",
"245 1 246 274",
"246 1 247 273",
"247 1 248 272",
"248 1 249 271",
"249 1 250 270",
"250 1 251 269",
"251 1 252 268",
"252 1 253 267",
"253 1 254 266",
"254 1 255 265",
"255 1 256 264",
"256 1 257 263",
"257 1 258 262",
"258 1 259 261",
"259 1 E 260",
"260 1 261 299",
"261 1 262 298",
"262 1 263 297",
"263 1 264 296",
"264 1 265 295",
"265 1 266 294",
"266 1 267 293",
"267 1 268 292",
"268 1 269 291",
"269 1 270 290",
"270 1 271 289",
"271 1 272 288",
"272 1 273 287",
"273 1 274 286",
"274 1 275 285",
"275 1 276 284",
"276 1 277 283",
"277 1 278 282",
"278 1 279 281",
"279 1 E 280",
"280 1 281 319",
"281 1 282 318",
"282 1 283 317",
"283 1 284 316",
"284 1 285 315",
"285 1 286 314",
"286 1 287 313",
"287 1 288 312",
"288 1 289 311",
"289 1 290 310",
"290 1 291 309",
"291 1 292 308",
"292 1 293 307",
"293 1 294 306",
"294 1 295 305",
"295 1 296 304",
"296 1 297 303",
"297 1 298 302",
"298 1 299 301",
"299 1 E 300",
"300 1 301 339",
"301 1 302 338",
"302 1 303 337",
"303 1 304 336",
"304 1 305 335",
"305 1 306 334",
"306 1 307 333",
"307 1 308 332",
"308 1 309 331",
"309 1 310 330",
"310 1 311 329",
"311 1 312 328",
"312 1 313 327",
"313 1 314 326",
"314 1 315 325",
"315 1 316 324",
"316 1 317 323",
"317 1 318 322",
"318 1 319 321",
"319 1 E 320",
"320 1 321 359",
"321 1 322 358",
"322 1 323 357",
"323 1 324 356",
"324 1 325 355",
"325 1 326 354",
"326 1 327 353",
"327 1 328 352",
"328 1 329 351",
"329 1 330 350",
"330 1 331 349",
"331 1 332 348",
"332 1 333 347",
"333 1 334 346",
"334 1 335 345",
"335 1 336 344",
"336 1 337 343",
"337 1 338 342",
"338 1 339 341",
"339 1 E 340",
"340 1 341 379",
"341 1 342 378",
"342 1 343 377",
"343 1 344 376",
"344 1 345 375",
"345 1 346 374",
"346 1 347 373",
"347 1 348 372",
"348 1 349 371",
"349 1 350 370",
"350 1 351 369",
"351 1 352 368",
"352 1 353 367",
"353 1 354 366",
"354 1 355 365",
"355 1 356 364",
"356 1 357 363",
"357 1 358 362",
"358 1 359 361",
"359 1 E 360",
"360 1 361 399",
"361 1 362 398",
"362 1 363 397",
"363 1 364 396",
"364 1 365 395",
"365 1 366 394",
"366 1 367 393",
"367 1 368 392",
"368 1 369 391",
"369 1 370 390",
"370 1 371 389",
"371 1 372 388",
"372 1 373 387",
"373 1 374 386",
"374 1 375 385",
"375 1 376 384",
"376 1 377 383",
"377 1 378 382",
"378 1 379 381",
"379 1 E 380",
"380 1 381 E",
"381 1 382 E",
"382 1 383 E",
"383 1 384 E",
"384 1 385 E",
"385 1 386 E",
"386 1 387 E",
"387 1 388 E",
"388 1 389 E",
"389 1 390 E",
"390 1 391 E",
"391 1 392 E",
"392 1 393 E",
"393 1 394 E",
"394 1 395 E",
"395 1 396 E",
"396 1 397 E",
"397 1 398 E",
"398 1 399 E",
"399 1 E E",
    };
}